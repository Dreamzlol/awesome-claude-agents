# A11y Fix
Analyzes modified files for WCAG 2.1 accessibility compliance and automatically applies fixes.

## Command Actions

The command will:
- Identify all currently modified files (staged and unstaged)
- Analyze Svelte components for accessibility issues
- Check against WCAG 2.1 Level AA guidelines
- Automatically apply accessibility fixes to the code
- Report what changes were made

## WCAG 2.1 Guidelines Checked

### 1. Perceivable
- **1.1.1 Non-text Content**: Images, icons, and interactive elements have appropriate alt text or aria-labels
- **1.3.1 Info and Relationships**: Proper semantic HTML structure and ARIA relationships
- **1.4.3 Contrast (Minimum)**: Text has sufficient color contrast (4.5:1 for normal text, 3:1 for large text)
- **1.4.11 Non-text Contrast**: UI components and graphical objects have 3:1 contrast ratio

### 2. Operable
- **2.1.1 Keyboard**: All interactive elements are keyboard accessible
- **2.1.2 No Keyboard Trap**: Users can navigate away from components using keyboard
- **2.4.3 Focus Order**: Focus order is logical and intuitive
- **2.4.7 Focus Visible**: Focus indicators are clearly visible

### 3. Understandable
- **3.2.2 On Input**: Form inputs don't cause unexpected context changes
- **3.3.1 Error Identification**: Form errors are clearly identified
- **3.3.2 Labels or Instructions**: Form inputs have clear labels or instructions

### 4. Robust
- **4.1.1 Parsing**: HTML is well-formed and valid
- **4.1.2 Name, Role, Value**: UI components have accessible names, roles, and values

## Analysis Process

### Svelte Component Analysis
For each modified `.svelte` file:

1. **Semantic HTML Structure**
   - Check for proper heading hierarchy (h1 → h2 → h3)
   - Verify landmark elements (main, nav, aside, section)
   - Validate form structure and labeling

2. **Interactive Elements**
   - Buttons have accessible names
   - Links have descriptive text or aria-labels
   - Form inputs have associated labels
   - Custom components have proper ARIA roles

3. **Color and Contrast**
   - Analyze CSS classes for color usage
   - Check for color-only information conveyance
   - Validate contrast ratios where possible

4. **Focus Management**
   - Ensure focusable elements are in tab order
   - Check for focus traps in modals/dialogs
   - Verify focus indicators are present

5. **ARIA Implementation**
   - Validate ARIA attributes usage
   - Check for redundant or conflicting ARIA
   - Ensure proper state management (aria-expanded, aria-selected)

## Automatic Fixes Applied

The command automatically applies these common accessibility fixes:

### Interactive Elements
- Add `aria-label` attributes to links and buttons without descriptive text
- Add `focus:outline-2 focus:outline-offset-2 focus:outline-blue-500` for visible focus indicators
- Add `role` and ARIA attributes to custom interactive elements

### Form Elements
- Add `aria-label` attributes to hidden form inputs
- Associate labels with form controls using `for` and `id` attributes
- Add `aria-describedby` for error messages and help text

### Lists and Navigation
- Add `aria-label` to lists that need context (product listings, navigation menus)
- Ensure proper heading hierarchy

### Color and Visual Elements
- Add `aria-label` to color swatches and visual indicators
- Add `role="img"` to decorative elements that convey meaning

## Output Format

### Applied Fixes Summary
```
✅ Applied accessibility fixes to 5 modified files:

CheckboxLink.svelte:
- Added aria-label="Filter by {data.text}" to link
- Added aria-label="Color: {data.text}" to color div  
- Added focus indicators

Teaser.svelte:
- Added aria-label="View {name} - Starting at {data.prices.current}" to product link
- Added focus indicators to product link
- Added aria-label attributes to hidden form inputs

Checkbox.svelte:
- Enhanced focus indicators

ProductFeed.svelte:
- Added aria-label="Product listings for {category?.name || 'products'}" to product list

All critical WCAG 2.1 compliance issues resolved.
```

## Common Patterns in Svelte Components

### Form Inputs
```svelte
<!-- Good -->
<label for="email">Email Address *</label>
<input 
    id="email" 
    type="email" 
    required 
    aria-describedby="email-error"
    aria-invalid={hasError}
/>
<div id="email-error" role="alert">
    {#if hasError}Email is required{/if}
</div>
```

### Custom Buttons
```svelte
<!-- Good -->
<button 
    type="button"
    aria-expanded={isOpen}
    aria-controls="dropdown-menu"
    on:click={toggleDropdown}
>
    Options
    <Icon name="chevron-down" aria-hidden="true" />
</button>
```

### Modal Dialogs
```svelte
<!-- Good -->
<div 
    role="dialog" 
    aria-modal="true"
    aria-labelledby="modal-title"
    aria-describedby="modal-description"
>
    <h2 id="modal-title">Confirm Action</h2>
    <p id="modal-description">Are you sure you want to proceed?</p>
    <!-- Content -->
</div>
```

## Integration with Development Workflow

### Pre-commit Hook
```bash
#!/bin/sh
# Run accessibility check on staged files
npm run a11y:check --staged
if [ $? -ne 0 ]; then
    echo "❌ Accessibility issues found. Please fix before committing."
    exit 1
fi
```

### CI/CD Integration
```yaml
- name: Accessibility Check
  run: npm run a11y:check --fail-on-critical
```

## Tools and Resources

### Automated Testing
- `@axe-core/svelte` for runtime accessibility testing
- `eslint-plugin-jsx-a11y` for static analysis
- `pa11y` for URL-based testing

### Manual Testing
- Screen reader testing (NVDA, JAWS, VoiceOver)
- Keyboard-only navigation
- High contrast mode testing
- Color blindness simulation

### References
- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [Svelte Accessibility Documentation](https://svelte.dev/docs/accessibility-warnings)
- [Web.dev Accessibility](https://web.dev/learn/accessibility/)